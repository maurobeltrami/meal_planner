{% load static %}
{% load core_tags %}  <!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>SpesaFacile</title>
    <link rel="stylesheet" href="{% static 'core/style.css' %}">
</head>
<body>
    <h1>SpesaFacile</h1>
    <h2>Piano Settimanale</h2>

    <div class="form-section">
        <h3>Calendario</h3>
        <div class="grid-container">
            <div class="header">Giorno</div> 
            {% for meal_code, meal_name in meal_types %}
                <div class="header">{{ meal_name }}</div>
            {% endfor %}

            {% for day_code, day_name in day_choices %}
                <div class="cell day-cell">{{ day_name }}</div>
                
                {% for meal_code, meal_name in meal_types %}
                    <div class="cell meal-cell">
                        {% with recipe_data=meal_grid|get_item:day_code|get_item:'meals'|get_item:meal_code %}
                            {% if recipe_data and recipe_data.name %}
                                <a href="{% url 'recipe_update' pk=recipe_data.pk %}" class="recipe-link">
                                    {{ recipe_data.name }}
                                </a>
                            {% else %}
                                <em>Non Pianificato</em>
                            {% endif %}
                        {% endwith %}
                    </div>
                {% endfor %}
            {% endfor %}
        </div>
    </div>

    <div class="form-section">
        <h3>Assegna un Pasto</h3>
        <form method="post">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit">Aggiorna Piano</button>
        </form>
    </div>

    <div class="forms-container">
        
        <div class="action-box">
            <a href="{% url 'shopping_list' %}" class="big-link style-shopping">
                <i>üõí</i>
                <strong>Lista della Spesa</strong>
                <small>(Calcolo Aggregato)</small>
            </a>
        </div>

        <div class="action-box">
            <a href="{% url 'recipe_create' %}" class="big-link style-create">
                <i>‚ú®</i>
                <strong>Crea Nuova Ricetta</strong>
                <small>(Aggiungi ingredienti)</small>
            </a>
        </div>

        <div class="action-box">
            <a href="{% url 'recipe_list' %}" class="big-link style-edit">
                <i>üìù</i>
                <strong>Modifica Ricette</strong>
                <small>(Scegli dalla lista)</small>
            </a>
        </div>

    </div>

</body>
</html>
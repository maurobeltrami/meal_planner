{% load custom_filters %} 
{% load static %}
<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Piano Settimanale</title>
    <link rel="stylesheet" href="{% static 'core/style.css' %}"> 
</head>
<body>
    <h1>üóìÔ∏è Il Tuo Piano Settimanale</h1>
    
    <div class="forms-container" style="grid-template-columns: 1fr 1fr 1fr; margin-bottom: 20px;">
        <div class="action-box">
            <a href="{% url 'shopping_list' %}" class="big-link style-accent">
                ‚û°Ô∏è Lista della Spesa
            </a>
        </div>
        <div class="action-box">
            <a href="{% url 'recipe_create' %}" class="big-link style-create">
                ‚ûï Crea Nuova Ricetta
            </a>
        </div>
        <div class="action-box">
            <a href="{% url 'recipe_list' %}" class="big-link style-edit">
                ‚úçÔ∏è Modifica Ricetta
            </a>
        </div>
    </div>
    
    <div class="form-section" style="margin-bottom: 30px;">
        <h3>‚úèÔ∏è Aggiungi o Modifica Pasto nel Piano</h3>
        <form method="post">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit">Salva Pasto</button>
        </form>
    </div>

    <div class="grid-container">
        <div class="header">Giorno</div>
        {% for meal_code, meal_name in meal_types %}
            <div class="header">{{ meal_name }}</div>
        {% endfor %}

        {% for day_code, day_data in meal_grid.items %}
            <div class="cell day-cell">{{ day_data.name }}</div>
            
            {% for meal_code, meal_name in meal_types %}
                <div class="cell meal-cell">
                    {% with meal_data=day_data.meals|get_item:meal_code %}
                        {% if meal_data %}
                            <a href="{% url 'recipe_update' pk=meal_data.pk %}" class="recipe-link">
                                {{ meal_data.name }}
                            </a>
                        {% else %}
                            - (Vuoto) -
                        {% endif %}
                    {% endwith %}
                </div>
            {% endfor %}
        {% endfor %}
    </div>
</body>
</html>